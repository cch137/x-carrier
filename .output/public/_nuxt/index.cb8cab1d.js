import{u as S,E as T}from"./el-button.82fb4b1a.js";import{b as $,c as E,_ as z,w as B,u as D,a as N,r as P,d as I}from"./useAuth.e44ee3e1.js";import{f as x,u as U,g as V,o as f,h as j,w as i,r as O,n as R,i as a,j as q,k as L,l as A,c as m,a as d,b as l,d as u,m as H,F as K,q as W,t as Y}from"./entry.506f3cf6.js";import{_ as G}from"./nuxt-link.0f807e02.js";import{u as J,E as y}from"./useTitle.e23f3c6e.js";import{a as M}from"./app.36c0a517.js";import"./vue.f36acd1f.2cd25342.js";const Q=$({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:E,default:""},truncated:{type:Boolean},tag:{type:String,default:"span"}}),X=x({name:"ElText"}),Z=x({...X,props:Q,setup(k){const _=k,n=S(),c=U("text"),g=V(()=>[c.b(),c.m(_.type),c.m(n.value),c.is("truncated",_.truncated)]);return(p,h)=>(f(),j(q(p.tag),{class:R(a(g))},{default:i(()=>[O(p.$slots,"default")]),_:3},8,["class"]))}});var ee=z(Z,[["__file","/home/runner/work/element-plus/element-plus/packages/components/text/src/text.vue"]]);const te=B(ee);const ne={class:"mt-8 flex-col flex-center"},se={key:0},ae={style:{display:"none"}},oe={class:"FileList mt-8"},le={key:0},ie={class:"text-center select-none"},ce={class:"FileItem flex justify-center items-center"},re=["href"],de={key:1},ue=d("h1",null,"Welcome to Drive!",-1),fe={class:"mt-8 text-center"},xe=x({__name:"index",setup(k){const{isLoggedIn:_}=D(),n=L(!1),c=L([]);async function g(){try{const t=await $fetch("/api/drive/list",{method:"POST"});c.value=t.data}catch{}}async function p(){n.value=!0;const t=y.service({text:"Loading..."});await g(),n.value=!1,t.close()}function h(){return document.querySelector(".FileUpload")}async function C(){n.value=!0;const t=y.service({text:"Loading..."}),e=new FormData,o=h().files||[];for(let s=0;s<o.length;s++)e.append(`${s}`,o[s]);await $fetch("/api/drive/file",{method:"POST",body:e}),n.value=!1,t.close()}async function b(t){n.value=!0;const e=y.service({text:"Loading..."});await $fetch("/api/drive/file",{method:"DELETE",body:{fp:t}}),n.value=!1,e.close()}A(_,t=>t?p():null),_.value&&p();async function F(){const t=new AbortController,e=await fetch("/api/drive/event",{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",signal:t.signal}),o=new TextDecoder,s=e.body.getReader(),v=async()=>{await s.read().then(async({value:r,done:w})=>{w||(o.decode(r),g(),v())})};v()}return F(),J(`Home - ${M}`),(t,e)=>{const o=T,s=te,v=G;return f(),m("div",ne,[a(_)?(f(),m("div",se,[d("div",null,[l(o,{icon:a(N),onClick:e[0]||(e[0]=r=>h().click()),loading:a(n)},{default:i(()=>[u("Upload")]),_:1},8,["icon","loading"]),l(o,{icon:a(P),onClick:e[1]||(e[1]=r=>p()),loading:a(n)},{default:i(()=>[u("Refresh")]),_:1},8,["icon","loading"]),d("form",ae,[d("input",{class:"FileUpload",type:"file",multiple:"",onChange:e[2]||(e[2]=r=>C())},null,32)])]),d("div",oe,[a(c).length===0?(f(),m("div",le,[d("div",ie,[l(s,{type:"info"},{default:i(()=>[u("No files")]),_:1})])])):H("",!0),(f(!0),m(K,null,W(a(c),r=>(f(),m("div",ce,[d("a",{class:"flex-1",href:`/api/drive/file/${r}`,target:"_blank"},[l(s,{size:"large"},{default:i(()=>[u(Y(r),1)]),_:2},1024)],8,re),l(o,{class:"FileItemDeleteBtn mx-1",icon:a(I),type:"danger",plain:"",loading:a(n),onClick:w=>b(r)},null,8,["icon","loading","onClick"])]))),256))])])):(f(),m("div",de,[ue,d("div",fe,[l(s,{size:"large"},{default:i(()=>[u("You are not logged in. ")]),_:1}),l(s,{size:"large"},{default:i(()=>[u("Please ")]),_:1}),l(v,{href:"/login"},{default:i(()=>[l(o,{size:"small",class:"HomepageLoginButton mb-1"},{default:i(()=>[u("Log In")]),_:1})]),_:1})])]))])}}});export{xe as default};
